{"ast":null,"code":"import axios from 'axios';\nexport default {\n  data() {\n    return {\n      cartItems: [],\n      userId: localStorage.getItem('userId')\n    };\n  },\n  methods: {\n    fetchCartItems() {\n      axios.get(`${process.env.VUE_APP_BACKEND_URL}/cart/${this.userId}`).then(response => {\n        this.cartItems = response.data;\n      }).catch(error => {\n        console.error('Failed to fetch cart items:', error);\n      });\n    },\n    async purchaseItems() {\n      try {\n        const purchasePromises = this.cartItems.map(async item => {\n          const response = await axios.post(`${process.env.VUE_APP_BACKEND_URL}/orders`, {\n            userId: this.userId,\n            itemId: item.item_id,\n            quantity: item.quantity\n          });\n          return response.data;\n        });\n        const purchaseResults = await Promise.all(purchasePromises);\n        console.log('Purchase results:', purchaseResults);\n\n        // 구매 완료 후 장바구니 비우기\n        this.cartItems = [];\n        alert('구매가 완료되었습니다.');\n      } catch (error) {\n        console.error('Failed to complete purchase:', error);\n        alert('구매에 실패했습니다.');\n      }\n    },\n    removeItem(itemId) {\n      axios.delete(`${process.env.VUE_APP_BACKEND_URL}/cart/${this.userId}/${itemId}`).then(() => {\n        this.cartItems = this.cartItems.filter(item => item.item_id !== itemId);\n      }).catch(error => {\n        console.error('Failed to remove item from cart:', error);\n      });\n    }\n  },\n  created() {\n    this.fetchCartItems();\n  }\n};","map":{"version":3,"names":["axios","data","cartItems","userId","localStorage","getItem","methods","fetchCartItems","get","process","env","VUE_APP_BACKEND_URL","then","response","catch","error","console","purchaseItems","purchasePromises","map","item","post","itemId","item_id","quantity","purchaseResults","Promise","all","log","alert","removeItem","delete","filter","created"],"sources":["D:\\SecureCoding-Shopping-Site-A-MEN\\my-diary-app\\client\\src\\components\\CartPage.vue"],"sourcesContent":["<template>\r\n    <div class=\"cart-container\">\r\n      <header>\r\n        <h1 @click=\"goToMainPage\">108번가</h1>\r\n        <div class=\"user-info\">\r\n          {{ userName }}님 | \r\n          <router-link to=\"/mypage\">마이페이지</router-link> |\r\n          <a href=\"#\" @click=\"logout\">로그아웃</a>\r\n        </div>\r\n      </header>\r\n      <main>\r\n        <h2>내 장바구니</h2>\r\n        <div v-if=\"cartItems.length === 0\">장바구니가 비어 있습니다.</div>\r\n        <div v-else>\r\n          <div v-for=\"item in cartItems\" :key=\"item.id\" class=\"cart-item\">\r\n            <img :src=\"getImageUrl(item.image_url)\" alt=\"Item Image\" class=\"item-image\" />\r\n            <p>{{ item.name }} ({{ item.quantity }})</p>\r\n            <button @click=\"removeFromCart(item.id)\">삭제</button>\r\n          </div>\r\n          <button @click=\"checkout\">구매하기</button>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      cartItems: [],\r\n      userId: localStorage.getItem('userId'),\r\n    };\r\n  },\r\n  methods: {\r\n    fetchCartItems() {\r\n      axios.get(`${process.env.VUE_APP_BACKEND_URL}/cart/${this.userId}`)\r\n        .then(response => {\r\n          this.cartItems = response.data;\r\n        })\r\n        .catch(error => {\r\n          console.error('Failed to fetch cart items:', error);\r\n        });\r\n    },\r\n    async purchaseItems() {\r\n      try {\r\n        const purchasePromises = this.cartItems.map(async item => {\r\n          const response = await axios.post(`${process.env.VUE_APP_BACKEND_URL}/orders`, {\r\n            userId: this.userId,\r\n            itemId: item.item_id,\r\n            quantity: item.quantity\r\n          });\r\n          return response.data;\r\n        });\r\n\r\n        const purchaseResults = await Promise.all(purchasePromises);\r\n        console.log('Purchase results:', purchaseResults);\r\n\r\n        // 구매 완료 후 장바구니 비우기\r\n        this.cartItems = [];\r\n        alert('구매가 완료되었습니다.');\r\n      } catch (error) {\r\n        console.error('Failed to complete purchase:', error);\r\n        alert('구매에 실패했습니다.');\r\n      }\r\n    },\r\n    removeItem(itemId) {\r\n      axios.delete(`${process.env.VUE_APP_BACKEND_URL}/cart/${this.userId}/${itemId}`)\r\n        .then(() => {\r\n          this.cartItems = this.cartItems.filter(item => item.item_id !== itemId);\r\n        })\r\n        .catch(error => {\r\n          console.error('Failed to remove item from cart:', error);\r\n        });\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchCartItems();\r\n  }\r\n};\r\n</script>\r\n\r\n  \r\n  <style>\r\n  .cart-container {\r\n    text-align: center;\r\n  }\r\n  header {\r\n    background-color: #f8f9fa;\r\n    padding: 20px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  }\r\n  h1 {\r\n    margin: 0;\r\n    cursor: pointer;\r\n  }\r\n  main {\r\n    padding: 20px;\r\n  }\r\n  .cart-item {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin: 10px;\r\n    padding: 10px;\r\n    border-bottom: 1px solid #ddd;\r\n  }\r\n  .item-image {\r\n    width: 50px;\r\n    height: 50px;\r\n    object-fit: cover;\r\n  }\r\n  button {\r\n    padding: 10px 20px;\r\n    font-size: 16px;\r\n    cursor: pointer;\r\n    margin: 5px;\r\n  }\r\n  </style>\r\n  "],"mappings":"AA0BA,OAAOA,KAAI,MAAO,OAAO;AAEzB,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,SAAS,EAAE,EAAE;MACbC,MAAM,EAAEC,YAAY,CAACC,OAAO,CAAC,QAAQ;IACvC,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPC,cAAcA,CAAA,EAAG;MACfP,KAAK,CAACQ,GAAG,CAAE,GAAEC,OAAO,CAACC,GAAG,CAACC,mBAAoB,SAAQ,IAAI,CAACR,MAAO,EAAC,EAC/DS,IAAI,CAACC,QAAO,IAAK;QAChB,IAAI,CAACX,SAAQ,GAAIW,QAAQ,CAACZ,IAAI;MAChC,CAAC,EACAa,KAAK,CAACC,KAAI,IAAK;QACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;MACrD,CAAC,CAAC;IACN,CAAC;IACD,MAAME,aAAaA,CAAA,EAAG;MACpB,IAAI;QACF,MAAMC,gBAAe,GAAI,IAAI,CAAChB,SAAS,CAACiB,GAAG,CAAC,MAAMC,IAAG,IAAK;UACxD,MAAMP,QAAO,GAAI,MAAMb,KAAK,CAACqB,IAAI,CAAE,GAAEZ,OAAO,CAACC,GAAG,CAACC,mBAAoB,SAAQ,EAAE;YAC7ER,MAAM,EAAE,IAAI,CAACA,MAAM;YACnBmB,MAAM,EAAEF,IAAI,CAACG,OAAO;YACpBC,QAAQ,EAAEJ,IAAI,CAACI;UACjB,CAAC,CAAC;UACF,OAAOX,QAAQ,CAACZ,IAAI;QACtB,CAAC,CAAC;QAEF,MAAMwB,eAAc,GAAI,MAAMC,OAAO,CAACC,GAAG,CAACT,gBAAgB,CAAC;QAC3DF,OAAO,CAACY,GAAG,CAAC,mBAAmB,EAAEH,eAAe,CAAC;;QAEjD;QACA,IAAI,CAACvB,SAAQ,GAAI,EAAE;QACnB2B,KAAK,CAAC,cAAc,CAAC;MACvB,EAAE,OAAOd,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;QACpDc,KAAK,CAAC,aAAa,CAAC;MACtB;IACF,CAAC;IACDC,UAAUA,CAACR,MAAM,EAAE;MACjBtB,KAAK,CAAC+B,MAAM,CAAE,GAAEtB,OAAO,CAACC,GAAG,CAACC,mBAAoB,SAAQ,IAAI,CAACR,MAAO,IAAGmB,MAAO,EAAC,EAC5EV,IAAI,CAAC,MAAM;QACV,IAAI,CAACV,SAAQ,GAAI,IAAI,CAACA,SAAS,CAAC8B,MAAM,CAACZ,IAAG,IAAKA,IAAI,CAACG,OAAM,KAAMD,MAAM,CAAC;MACzE,CAAC,EACAR,KAAK,CAACC,KAAI,IAAK;QACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;MAC1D,CAAC,CAAC;IACN;EACF,CAAC;EACDkB,OAAOA,CAAA,EAAG;IACR,IAAI,CAAC1B,cAAc,CAAC,CAAC;EACvB;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}