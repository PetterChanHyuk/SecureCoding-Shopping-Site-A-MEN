{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  class: \"order-history-container\"\n};\nconst _hoisted_2 = {\n  class: \"user-info\"\n};\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"구매 목록\", -1 /* HOISTED */);\nconst _hoisted_4 = {\n  key: 0\n};\nconst _hoisted_5 = {\n  key: 1\n};\nconst _hoisted_6 = {\n  class: \"order-details\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"header\", null, [_createElementVNode(\"h1\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.goToMainPage && $options.goToMainPage(...args))\n  }, \"108번가\"), _createElementVNode(\"div\", _hoisted_2, [_createTextVNode(_toDisplayString($data.userName) + \"님 | \", 1 /* TEXT */), _createVNode(_component_router_link, {\n    to: \"/mypage\"\n  }, {\n    default: _withCtx(() => [_createTextVNode(\"마이페이지\")]),\n    _: 1 /* STABLE */\n  }), _createTextVNode(\" | \"), _createElementVNode(\"a\", {\n    href: \"#\",\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.logout && $options.logout(...args))\n  }, \"로그아웃\")])]), _createElementVNode(\"main\", null, [_hoisted_3, $data.orders.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, \"구매 목록이 없습니다.\")) : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.orders, order => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: order.id,\n      class: \"order-item\"\n    }, [_createElementVNode(\"h3\", null, \"주문 ID: \" + _toDisplayString(order.id), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_6, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(order.items, item => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        key: item.id,\n        class: \"order-item-details\"\n      }, [_createElementVNode(\"p\", null, _toDisplayString(item.name) + \" - \" + _toDisplayString(item.quantity) + \"개 - \" + _toDisplayString(item.price) + \"원\", 1 /* TEXT */)]);\n    }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"p\", null, \"총 금액: \" + _toDisplayString(order.total_amount) + \"원\", 1 /* TEXT */)]);\n  }), 128 /* KEYED_FRAGMENT */))]))])]);\n}","map":{"version":3,"names":["class","_createElementVNode","key","_createElementBlock","_hoisted_1","onClick","_cache","args","$options","goToMainPage","_hoisted_2","_createTextVNode","_toDisplayString","$data","userName","_createVNode","_component_router_link","to","default","_withCtx","_","href","logout","_hoisted_3","orders","length","_hoisted_4","_hoisted_5","_Fragment","_renderList","order","id","_hoisted_6","items","item","name","quantity","price","total_amount"],"sources":["D:\\SecureCoding-Shopping-Site-A-MEN\\my-diary-app\\client\\src\\components\\OrderHistoryPage.vue"],"sourcesContent":["<template>\r\n    <div class=\"order-history-container\">\r\n      <header>\r\n        <h1 @click=\"goToMainPage\">108번가</h1>\r\n        <div class=\"user-info\">\r\n          {{ userName }}님 | \r\n          <router-link to=\"/mypage\">마이페이지</router-link> |\r\n          <a href=\"#\" @click=\"logout\">로그아웃</a>\r\n        </div>\r\n      </header>\r\n      <main>\r\n        <h2>구매 목록</h2>\r\n        <div v-if=\"orders.length === 0\">구매 목록이 없습니다.</div>\r\n        <div v-else>\r\n          <div v-for=\"order in orders\" :key=\"order.id\" class=\"order-item\">\r\n            <h3>주문 ID: {{ order.id }}</h3>\r\n            <div class=\"order-details\">\r\n              <div v-for=\"item in order.items\" :key=\"item.id\" class=\"order-item-details\">\r\n                <p>{{ item.name }} - {{ item.quantity }}개 - {{ item.price }}원</p>\r\n              </div>\r\n            </div>\r\n            <p>총 금액: {{ order.total_amount }}원</p>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import axios from 'axios';\r\n  \r\n  export default {\r\n    data() {\r\n      return {\r\n        userName: '익명',\r\n        orders: []\r\n      };\r\n    },\r\n    methods: {\r\n      fetchOrders() {\r\n        const userId = localStorage.getItem('userId');\r\n        axios.get(`${process.env.VUE_APP_BACKEND_URL}/orders/${userId}`)\r\n          .then(response => {\r\n            this.orders = response.data;\r\n          })\r\n          .catch(error => {\r\n            console.error('Failed to fetch orders:', error);\r\n          });\r\n      },\r\n      fetchUserName() {\r\n        axios.get(`${process.env.VUE_APP_BACKEND_URL}/username`, {\r\n          params: {\r\n            userId: localStorage.getItem('userId')\r\n          }\r\n        })\r\n        .then(response => {\r\n          this.userName = response.data.name;\r\n        })\r\n        .catch(error => {\r\n          console.error('Error fetching user name:', error);\r\n        });\r\n      },\r\n      goToMainPage() {\r\n        this.$router.push('/mainpage');\r\n      },\r\n      logout() {\r\n        const userId = localStorage.getItem('userId');\r\n        if (userId) {\r\n          axios.post(`${process.env.VUE_APP_BACKEND_URL}/userlogout`, { userId })\r\n            .then(() => {\r\n              localStorage.removeItem('userId');\r\n              this.$router.push('/userlogin');\r\n            })\r\n            .catch(error => {\r\n              console.error('로그아웃 실패:', error);\r\n            });\r\n        }\r\n      }\r\n    },\r\n    created() {\r\n      this.fetchUserName();\r\n      this.fetchOrders();\r\n      \r\n      const userId = localStorage.getItem('userId');\r\n      if (!userId) {\r\n        alert(\"비정상적인 접근입니다.\");\r\n        this.$router.push('/userlogin');\r\n      }\r\n    }\r\n  };\r\n  </script>\r\n  \r\n  <style>\r\n  .order-history-container {\r\n    text-align: center;\r\n  }\r\n  header {\r\n    background-color: #f8f9fa;\r\n    padding: 20px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  }\r\n  h1 {\r\n    margin: 0;\r\n    cursor: pointer;\r\n  }\r\n  main {\r\n    padding: 20px;\r\n  }\r\n  .order-item {\r\n    border: 1px solid #dee2e6;\r\n    padding: 10px;\r\n    margin: 10px 0;\r\n  }\r\n  .order-item-details {\r\n    padding-left: 20px;\r\n  }\r\n  button {\r\n    padding: 10px 20px;\r\n    font-size: 16px;\r\n    cursor: pointer;\r\n    background-color: #007bff;\r\n    color: white;\r\n    border: none;\r\n    border-radius: 5px;\r\n  }\r\n  button:hover {\r\n    background-color: #0056b3;\r\n  }\r\n  </style>\r\n  "],"mappings":";;EACSA,KAAK,EAAC;AAAyB;;EAG3BA,KAAK,EAAC;AAAW;gCAOtBC,mBAAA,CAAc,YAAV,OAAK;;EAXjBC,GAAA;AAAA;;EAAAA,GAAA;AAAA;;EAgBiBF,KAAK,EAAC;AAAe;;;uBAflCG,mBAAA,CAwBM,OAxBNC,UAwBM,GAvBJH,mBAAA,CAOS,iBANPA,mBAAA,CAAoC;IAA/BI,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAC,YAAA,IAAAD,QAAA,CAAAC,YAAA,IAAAF,IAAA,CAAY;KAAE,OAAK,GAC/BN,mBAAA,CAIM,OAJNS,UAIM,GARdC,gBAAA,CAAAC,gBAAA,CAKaC,KAAA,CAAAC,QAAQ,IAAG,MACd,iBAAAC,YAAA,CAA6CC,sBAAA;IAAhCC,EAAE,EAAC;EAAS;IANnCC,OAAA,EAAAC,QAAA,CAMoC,MAAK,CANzCR,gBAAA,CAMoC,OAAK,E;IANzCS,CAAA;MAAAT,gBAAA,CAMuD,KAC7C,GAAAV,mBAAA,CAAoC;IAAjCoB,IAAI,EAAC,GAAG;IAAEhB,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAc,MAAA,IAAAd,QAAA,CAAAc,MAAA,IAAAf,IAAA,CAAM;KAAE,MAAI,E,KAGpCN,mBAAA,CAcO,eAbLsB,UAAc,EACHV,KAAA,CAAAW,MAAM,CAACC,MAAM,U,cAAxBtB,mBAAA,CAAkD,OAZ1DuB,UAAA,EAYwC,cAAY,M,cAC5CvB,mBAAA,CAUM,OAvBdwB,UAAA,I,kBAcUxB,mBAAA,CAQMyB,SAAA,QAtBhBC,WAAA,CAc+BhB,KAAA,CAAAW,MAAM,EAAfM,KAAK;yBAAjB3B,mBAAA,CAQM;MARwBD,GAAG,EAAE4B,KAAK,CAACC,EAAE;MAAE/B,KAAK,EAAC;QACjDC,mBAAA,CAA8B,YAA1B,SAAO,GAAAW,gBAAA,CAAGkB,KAAK,CAACC,EAAE,kBACtB9B,mBAAA,CAIM,OAJN+B,UAIM,I,kBAHJ7B,mBAAA,CAEMyB,SAAA,QAnBpBC,WAAA,CAiBkCC,KAAK,CAACG,KAAK,EAAnBC,IAAI;2BAAhB/B,mBAAA,CAEM;QAF4BD,GAAG,EAAEgC,IAAI,CAACH,EAAE;QAAE/B,KAAK,EAAC;UACpDC,mBAAA,CAAiE,WAAAW,gBAAA,CAA3DsB,IAAI,CAACC,IAAI,IAAG,KAAG,GAAAvB,gBAAA,CAAGsB,IAAI,CAACE,QAAQ,IAAG,MAAI,GAAAxB,gBAAA,CAAGsB,IAAI,CAACG,KAAK,IAAG,GAAC,gB;sCAGjEpC,mBAAA,CAAsC,WAAnC,QAAM,GAAAW,gBAAA,CAAGkB,KAAK,CAACQ,YAAY,IAAG,GAAC,gB"},"metadata":{},"sourceType":"module","externalDependencies":[]}