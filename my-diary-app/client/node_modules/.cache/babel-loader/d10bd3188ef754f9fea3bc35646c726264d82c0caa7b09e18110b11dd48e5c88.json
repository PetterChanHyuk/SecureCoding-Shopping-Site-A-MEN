{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, vModelSelect as _vModelSelect, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"add-item-container\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"h1\", null, \"새로운 아이템 추가\", -1 /* HOISTED */);\nconst _hoisted_3 = {\n  class: \"form-group\"\n};\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"itemName\"\n}, \"Item Name\", -1 /* HOISTED */);\nconst _hoisted_5 = {\n  key: 0,\n  class: \"error-message\"\n};\nconst _hoisted_6 = {\n  class: \"form-group\"\n};\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"category\"\n}, \"Category\", -1 /* HOISTED */);\nconst _hoisted_8 = {\n  class: \"custom-select-container\"\n};\nconst _hoisted_9 = [\"value\"];\nconst _hoisted_10 = [\"disabled\"];\nconst _hoisted_11 = {\n  key: 0,\n  class: \"error-message\"\n};\nconst _hoisted_12 = {\n  class: \"form-group\"\n};\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"itemDescription\"\n}, \"Item Description\", -1 /* HOISTED */);\nconst _hoisted_14 = {\n  class: \"form-group\"\n};\nconst _hoisted_15 = /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"file\"\n}, \"Image\", -1 /* HOISTED */);\nconst _hoisted_16 = /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\"\n}, \"추가\", -1 /* HOISTED */);\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"form\", {\n    onSubmit: _cache[8] || (_cache[8] = _withModifiers((...args) => $options.addItem && $options.addItem(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"itemName\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.itemName = $event),\n    onInput: _cache[1] || (_cache[1] = (...args) => $options.validateItemName && $options.validateItemName(...args)),\n    required: \"\"\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $data.itemName]]), $data.itemNameError ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, _toDisplayString($data.itemNameError), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_6, [_hoisted_7, _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", null, [_withDirectives(_createElementVNode(\"select\", {\n    id: \"category\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.selectedCategoryId = $event),\n    required: \"\",\n    size: \"1\",\n    class: \"category-select\"\n  }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.categories, category => {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: category.id,\n      value: category.id\n    }, _toDisplayString(category.name), 9 /* TEXT, PROPS */, _hoisted_9);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, $data.selectedCategoryId]])]), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.newCategory = $event),\n    onInput: _cache[4] || (_cache[4] = (...args) => $options.validateNewCategory && $options.validateNewCategory(...args)),\n    placeholder: \"Add new category\"\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $data.newCategory]]), _createElementVNode(\"button\", {\n    type: \"button\",\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.addCategory && $options.addCategory(...args)),\n    disabled: $data.newCategoryError || !$data.newCategory,\n    class: \"add-category-btn\"\n  }, \"Add Category\", 8 /* PROPS */, _hoisted_10)]), $data.newCategoryError ? (_openBlock(), _createElementBlock(\"p\", _hoisted_11, _toDisplayString($data.newCategoryError), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_12, [_hoisted_13, _withDirectives(_createElementVNode(\"textarea\", {\n    id: \"itemDescription\",\n    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $data.itemDescription = $event)\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.itemDescription]])]), _createElementVNode(\"div\", _hoisted_14, [_hoisted_15, _createElementVNode(\"input\", {\n    type: \"file\",\n    id: \"file\",\n    onChange: _cache[7] || (_cache[7] = (...args) => $options.onFileChange && $options.onFileChange(...args))\n  }, null, 32 /* NEED_HYDRATION */)]), _hoisted_16], 32 /* NEED_HYDRATION */)]);\n}","map":{"version":3,"names":["class","_createElementVNode","for","key","type","_createElementBlock","_hoisted_1","_hoisted_2","onSubmit","_cache","_withModifiers","args","$options","addItem","_hoisted_3","_hoisted_4","id","$event","$data","itemName","onInput","validateItemName","required","itemNameError","_hoisted_5","_toDisplayString","_createCommentVNode","_hoisted_6","_hoisted_7","_hoisted_8","selectedCategoryId","size","_Fragment","_renderList","categories","category","value","name","_hoisted_9","newCategory","validateNewCategory","placeholder","onClick","addCategory","disabled","newCategoryError","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","itemDescription","_hoisted_14","_hoisted_15","onChange","onFileChange","_hoisted_16"],"sources":["C:\\Users\\cba64\\Coding\\SecureCoding-Shopping-Site-A-MEN\\my-diary-app\\client\\src\\components\\AddItem.vue"],"sourcesContent":["<template>\r\n  <div class=\"add-item-container\">\r\n    <h1>새로운 아이템 추가</h1>\r\n    <form @submit.prevent=\"addItem\">\r\n      <div class=\"form-group\">\r\n        <label for=\"itemName\">Item Name</label>\r\n        <input type=\"text\" id=\"itemName\" v-model=\"itemName\" @input=\"validateItemName\" required />\r\n        <p v-if=\"itemNameError\" class=\"error-message\">{{ itemNameError }}</p>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"category\">Category</label>\r\n        <div class=\"custom-select-container\">\r\n          <div>\r\n            <select id=\"category\" v-model=\"selectedCategoryId\" required size=\"1\" class=\"category-select\">\r\n              <option v-for=\"category in categories\" :key=\"category.id\" :value=\"category.id\">\r\n                {{ category.name }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n          <input type=\"text\" v-model=\"newCategory\" @input=\"validateNewCategory\" placeholder=\"Add new category\" />\r\n          <button type=\"button\" @click=\"addCategory\" :disabled=\"newCategoryError || !newCategory\" class=\"add-category-btn\">Add Category</button>\r\n        </div>\r\n        <p v-if=\"newCategoryError\" class=\"error-message\">{{ newCategoryError }}</p>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"itemDescription\">Item Description</label>\r\n        <textarea id=\"itemDescription\" v-model=\"itemDescription\"></textarea>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"file\">Image</label>\r\n        <input type=\"file\" id=\"file\" @change=\"onFileChange\" />\r\n      </div>\r\n      <button type=\"submit\">추가</button>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      itemName: '',\r\n      selectedCategoryId: '',\r\n      newCategory: '',\r\n      itemDescription: '',\r\n      file: null,\r\n      categories: [],\r\n      itemNameError: '',\r\n      newCategoryError: ''\r\n    };\r\n  },\r\n  methods: {\r\n    validateItemName() {\r\n      const regex = /^[a-zA-Z0-9가-힣\\s]+$/;\r\n      if (!regex.test(this.itemName)) {\r\n        this.itemNameError = '특수문자는 사용할 수 없습니다.';\r\n      } else {\r\n        this.itemNameError = '';\r\n      }\r\n    },\r\n    validateNewCategory() {\r\n      const regex = /^[a-zA-Z0-9가-힣\\s]+$/;\r\n      if (!regex.test(this.newCategory)) {\r\n        this.newCategoryError = '특수문자는 사용할 수 없습니다.';\r\n      } else {\r\n        this.newCategoryError = '';\r\n      }\r\n    },\r\n    async fetchCategories() {\r\n      try {\r\n        const response = await axios.get(`${process.env.VUE_APP_BACKEND_URL}/categories`);\r\n        this.categories = response.data;\r\n      } catch (err) {\r\n        console.error('카테고리 목록을 불러오는 데 실패했습니다:', err);\r\n      }\r\n    },\r\n    onFileChange(event) {\r\n      const file = event.target.files[0];\r\n      const validTypes = ['image/jpeg', 'image/png', 'image/gif'];\r\n      const maxSize = 2 * 1024 * 1024; // 2MB\r\n\r\n      if (!validTypes.includes(file.type)) {\r\n        alert('유효하지 않은 파일 형식입니다. 이미지 파일을 업로드하세요.');\r\n        return;\r\n      }\r\n\r\n      if (file.size > maxSize) {\r\n        alert('파일 크기가 2MB를 초과합니다. 더 작은 파일을 업로드하세요.');\r\n        return;\r\n      }\r\n\r\n      this.file = file;\r\n    },\r\n    async addCategory() {\r\n      if (!this.newCategory || this.newCategoryError) {\r\n        alert('유효한 카테고리 이름을 입력해 주세요.');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await axios.post(`${process.env.VUE_APP_BACKEND_URL}/categories`, {\r\n          name: this.newCategory\r\n        });\r\n        this.categories.push(response.data);\r\n        this.newCategory = '';\r\n      } catch (err) {\r\n        console.error('카테고리 추가에 실패했습니다:', err);\r\n      }\r\n    },\r\n    async addItem() {\r\n      const userId = localStorage.getItem('userId'); // 사용자 ID 가져오기\r\n\r\n      if (!this.itemName || !this.selectedCategoryId || !userId || this.itemNameError) {\r\n        alert('모든 필수 항목을 올바르게 입력해 주세요.');\r\n        return;\r\n      }\r\n\r\n      let imageUrl = '';\r\n      if (this.file) {\r\n        const formData = new FormData();\r\n        formData.append('file', this.file);\r\n\r\n        try {\r\n          const uploadResponse = await axios.post(`${process.env.VUE_APP_BACKEND_URL}/upload`, formData, {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data'\r\n            }\r\n          });\r\n          imageUrl = uploadResponse.data.filePath;\r\n        } catch (err) {\r\n          console.error('파일 업로드에 실패했습니다:', err);\r\n          alert('파일 업로드에 실패했습니다.');\r\n          return;\r\n        }\r\n      }\r\n\r\n      try {\r\n        const response = await axios.post(`${process.env.VUE_APP_BACKEND_URL}/items`, {\r\n          name: this.itemName,\r\n          categoryId: this.selectedCategoryId,\r\n          imageUrl,\r\n          description: this.itemDescription,\r\n          userId // 사용자 ID 추가\r\n        });\r\n        console.log('아이템 추가에 성공했습니다:', response.data);\r\n        this.$router.push('/mainpage');\r\n      } catch (err) {\r\n        console.error('아이템 추가에 실패했습니다:', err);\r\n        alert('아이템 추가에 실패했습니다.');\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchCategories();\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.add-item-container {\r\n  width: 300px;\r\n  margin: auto;\r\n  padding: 20px;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n  text-align: center;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.custom-select-container {\r\n  position: relative;\r\n  display: flex;\r\n}\r\n\r\n.category-select {\r\n  flex: 1;\r\n  margin-right: 10px;\r\n  overflow-y: auto;\r\n  \r\n}\r\n\r\n.custom-select-container input[type=\"text\"] {\r\n  flex: 1;\r\n  margin-right: 10px;\r\n}\r\n\r\n.custom-select-container button {\r\n  flex-shrink: 0;\r\n}\r\n\r\n.custom-select-container::after {\r\n  content: '▼';\r\n  position: absolute;\r\n  top: 50%;\r\n  right: 10px;\r\n  transform: translateY(-50%);\r\n  pointer-events: none;\r\n}\r\n\r\n.error-message {\r\n  color: red;\r\n  font-size: 0.9em;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}